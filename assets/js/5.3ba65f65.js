(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{166:function(t,s,a){"use strict";a.r(s);var e=a(0),n=Object(e.a)({},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"content"},[t._m(0),t._v(" "),a("p",[t._v("我们今天来讲讲，啥是响应式，以及Vue是怎么来做到的")]),t._v(" "),t._m(1),t._v(" "),t._m(2),t._v(" "),a("p",[t._v("例如 a = b + c, 那么当b的数值发生变化时，a的值会随着b或c的值变化而自动变化")]),t._v(" "),t._m(3),t._v(" "),t._m(4),t._v(" "),t._m(5),t._v(" "),a("p",[t._v("响应式网页设计（英语：Responsive web design，通常缩写为RWD），或称自适应网页设计、回应式网页设计、对应式网页设计。 是一种网页设计的技术做法，该设计可使网站在不同的设备（从桌面计算机显示器到移动电话或其他移动产品设备）上浏览时对应不同分辨率皆有适合的呈现，减少用户进行缩放、平移和滚动等操作行为。我们更多情况下，会将其称为 页面多端适配")]),t._v(" "),t._m(6),t._v(" "),t._m(7),t._v(" "),a("p",[t._v("在前端展示页面当中，承载渲染输出的载体是HTML，这是一种类xml的超文本语言，内部的数据并不具有类似Excel的响应式刷新的功能，那么在页面越来越复杂的今天，展示静态页面已经远远不能满足我们的需求了")]),t._v(" "),a("p",[t._v("那么如果现在又一个证券交易平台的前端展示页面，要求头部数据随机显示一支涨幅在前十的股票，实时刷新，那么我们会怎么做？")]),t._v(" "),a("p",[t._v("通过querySelector从DOM中找到对应节点，动态的更新数据")]),t._v(" "),a("p",[t._v("没错，这个方法确实ok，那么假如旁边还有一栏需要显示涨幅最高的全部十只股票，并且价格也需要刷新呢，这时候我们刚刚的方法可能就不太奏效了")]),t._v(" "),a("p",[t._v("我们也可以用之前的方法。那么还有两栏也有这几只股票，也需要实时刷新呢？这时候再来一个一个替换，是不是会有点捉襟见肘了")]),t._v(" "),a("p",[t._v("那么假如这十只股票的价格都是响应式的，那么问题就解决了，我们只需要维护一个对象即可，后面所有的数据更新都是响应式的，不需要我们直接一个一个操作DOM了")]),t._v(" "),a("p",[t._v("That's why")]),t._v(" "),t._m(8),t._v(" "),a("p",[t._v("前端框架中，这也称为数据绑定，我们的数据和真实的DOM进行了绑定了，这也是个合适的比喻")]),t._v(" "),a("p",[t._v("为了实现上面的响应式，主要有下面几种方法：")]),t._v(" "),t._m(9),t._v(" "),t._m(10),t._v(" "),a("p",[t._v("这个模式十分经典了，就是传统的订阅模式")]),t._v(" "),a("p",[t._v("消息的发送者（称为发布者）不会将消息直接发送给特定的接收者（称为订阅者）。而是将发布的消息分为不同的类别，无需了解哪些订阅者（如果有的话）可能存在")]),t._v(" "),t._m(11),t._v(" "),a("p",[t._v("原理为通过定时器进行轮询查询，但是只在特定事件触发后进行脏值检测")]),t._v(" "),t._m(12),t._v(" "),t._m(13),t._v(" "),a("p",[t._v("这就是今天的重点了")]),t._v(" "),a("p",[t._v("劫持，泛指强制占据船舶、汽车等交通工具的控制权，如劫机")]),t._v(" "),a("p",[t._v("ES5中的新api Object.defineProperty 可以劫持所定义数值的 setter 和 getter")]),t._v(" "),t._m(14),a("p",[t._v("数据劫持的原理很简单，重点是怎么通过数据劫持实现响应式")]),t._v(" "),a("p",[t._v("当数据被DOM元素读取的时候，我们会触发get函数，那么这个时候我们需要将这个DOM记录一下，这个过程我们有个高大上的解释名词：依赖收集")]),t._v(" "),a("p",[t._v("当数据发生变化的时候，我们会出发set函数，那么，如果要实现数据响应式，set需要做一点工作，更新到上面收集的依赖DOM上，这里也有个高大上的解释名词：派发更新")]),t._v(" "),t._m(15),t._v(" "),a("p",[t._v("下面的图来自Vue官网")]),t._v(" "),t._m(16),t._v(" "),a("p",[t._v("别看着花里胡哨的，其实不是很复杂。")]),t._v(" "),a("p",[t._v("这里我们先看data，这里的getter setter，就是我们上面介绍的内容")]),t._v(" "),a("p",[t._v("进入data部分的操作是 render ‘Touch’， 指的是在页面初次渲染的时候，我们会使用了这个数据，接下来，getter指向watcher，完成一次依赖收集")]),t._v(" "),t._m(17),t._v(" "),a("p",[t._v("出data的部分，就是setter被触发后，告诉watcher，完成一次派发更新")]),t._v(" "),a("p",[t._v("灰常简单，重点是怎么用js实现，并且无侵入的融入到Vue这个框架内部，这部分在整个框架思路介绍完后，再细讲")]),t._v(" "),t._m(18),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://cn.vuejs.org/v2/guide/reactivity.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("深入响应式原理"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://zh.wikipedia.org/wiki/%E5%93%8D%E5%BA%94%E5%BC%8F%E7%BD%91%E9%A1%B5%E8%AE%BE%E8%AE%A1",target:"_blank",rel:"noopener noreferrer"}},[t._v("响应式网页设计"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://zh.wikipedia.org/wiki/%E5%93%8D%E5%BA%94%E5%BC%8F%E7%BC%96%E7%A8%8B",target:"_blank",rel:"noopener noreferrer"}},[t._v("响应式编程"),a("OutboundLink")],1)])])])},[function(){var t=this.$createElement,s=this._self._c||t;return s("h1",{attrs:{id:"响应式原理介绍"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#响应式原理介绍","aria-hidden":"true"}},[this._v("#")]),this._v(" 响应式原理介绍")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"广义的响应式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#广义的响应式","aria-hidden":"true"}},[this._v("#")]),this._v(" 广义的响应式")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("code",[this._v("响应式")]),this._v("是一种编程概念（英语：Reactive programming），是一种面向数据流和变化传播的编程范式。这意味着可以在编程语言中很方便地表达静态或动态的数据流，而相关的计算模型会"),s("code",[this._v("自动")]),this._v("将变化的值通过数据流进行传播")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("最简单的例子就是"),s("code",[this._v("Excel")]),this._v('的公式。单元格可以包含字面值或类似"=B1+C1"的公式，而包含公式的单元格的值会依据其他单元格的值的变化而变化')])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"前端中的响应式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#前端中的响应式","aria-hidden":"true"}},[this._v("#")]),this._v(" 前端中的响应式")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("code",[this._v("响应式")]),this._v("与"),s("code",[this._v("响应式网页设计")]),this._v("不同")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"前端为什么需要响应式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#前端为什么需要响应式","aria-hidden":"true"}},[this._v("#")]),this._v(" 前端为什么需要响应式")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("经常学习东西的时候，"),s("strong",[this._v("不光要埋头前进，还要抬头看路")]),this._v("，看看脚下这条路到底通到哪里")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"vue中的响应式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#vue中的响应式","aria-hidden":"true"}},[this._v("#")]),this._v(" Vue中的响应式")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("发布订阅模式（backbone.js）")]),this._v(" "),s("li",[this._v("脏值检查（Angular.js)")]),this._v(" "),s("li",[this._v("数据劫持 + 发布订阅（Vue.js）")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"发布订阅"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#发布订阅","aria-hidden":"true"}},[this._v("#")]),this._v(" 发布订阅")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"脏值检查"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#脏值检查","aria-hidden":"true"}},[this._v("#")]),this._v(" 脏值检查")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ul",[a("li",[t._v("DOM事件，譬如用户输入文本，点击按钮等。( ng-click )")]),t._v(" "),a("li",[t._v("XHR响应事件 ( $http )")]),t._v(" "),a("li",[t._v("浏览器Location变更事件 ( $location )")]),t._v(" "),a("li",[t._v("Timer事件( $timeout , $interval )")]),t._v(" "),a("li",[t._v("执行 $digest() 或 $apply()")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"数据劫持"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#数据劫持","aria-hidden":"true"}},[this._v("#")]),this._v(" 数据劫持")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{attrs:{class:"token keyword"}},[t._v("let")]),t._v(" val "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("1")]),t._v("\n\nObject"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("defineProperty")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" key"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{attrs:{class:"token keyword"}},[t._v("set")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("function")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("newVal"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("val "),a("span",{attrs:{class:"token operator"}},[t._v("===")]),t._v(" newVal"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("return")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        console"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("log")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'哈哈哈，监听到值变化了 '")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" val"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("' --\x3e '")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" newVal"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{attrs:{class:"token comment"}},[t._v("// 我没有劫持set函数，仍有赋值功能")]),t._v("\n        val "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" newVal"),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{attrs:{class:"token keyword"}},[t._v("get")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("function")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{attrs:{class:"token comment"}},[t._v("// 我劫持了get函数，每次data[key]只能取到0")]),t._v("\n        "),a("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("0")]),t._v("\n    "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"vue响应式实现"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#vue响应式实现","aria-hidden":"true"}},[this._v("#")]),this._v(" Vue响应式实现")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("img",{attrs:{src:"https://cn.vuejs.org/images/data.png",alt:"imgs"}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"tip custom-block"},[s("p",{staticClass:"custom-block-title"},[this._v("TIP")]),this._v(" "),s("p",[this._v("我们的依赖收集和派发更新是交给watcher来进行管理的，这个后续再说明哈")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"参考文献"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#参考文献","aria-hidden":"true"}},[this._v("#")]),this._v(" 参考文献")])}],!1,null,null,null);n.options.__file="2-响应式原理介绍.md";s.default=n.exports}}]);